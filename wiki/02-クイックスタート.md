# ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

## å‰ææ¡ä»¶

- Node.js 20.xï¼ˆline-ai-bot ãŒæŒ‡å®šï¼‰(å‚ç…§: apps/line-ai-bot/package.json:1-16)
- Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆURL + Service Role Keyï¼‰
- LINE Developersï¼ˆãƒãƒ£ãƒãƒ«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ/ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
- OpenAI API ã‚­ãƒ¼

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ¦‚è¦

```mermaid
flowchart TD
  Setup[ç’°å¢ƒå¤‰æ•°æº–å‚™] --> ReviewInstall[review-page ä¾å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«]
  Setup --> SubjectInstall[subject-browser ä¾å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«]
  Setup --> LineInstall[line-ai-bot ä¾å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«]
  ReviewInstall --> ReviewDev[review-page èµ·å‹•]
  SubjectInstall --> SubjectDev[subject-browser èµ·å‹•]
  LineInstall --> LineDev[line-ai-bot èµ·å‹•]
```

## 1. ç’°å¢ƒå¤‰æ•°

review-page ã¯ `.env.example` ã‚’åŸºã«è¨­å®šã—ã¾ã™ã€‚(å‚ç…§: apps/review-page/.env.example:1-6)

```env
NEXT_PUBLIC_LIFF_ID=... # LINE LIFF ID
SUPABASE_URL=...        # Supabase URL
SUPABASE_SERVICE_ROLE_KEY=... # Service Role Key
OPENAI_API_KEY=...      # OpenAI API Key
LINE_HASH_PEPPER=...    # LINE userId ãƒãƒƒã‚·ãƒ¥ã® pepper
```
(å‚ç…§: apps/review-page/.env.example:1-6)

line-ai-bot ã¯ `api/webhook.js` ã®ã‚³ãƒ¡ãƒ³ãƒˆã«å¿…è¦ãªç’°å¢ƒå¤‰æ•°ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

```text
SUPABASE_URL
SUPABASE_SERVICE_ROLE_KEY
LINE_CHANNEL_SECRET
LINE_CHANNEL_ACCESS_TOKEN
OPENAI_API_KEY
ASK_REVIEW_API_URL   # review-page å´ã® /api/review-ask
ASK_COMPANY_API_URL  # review-page å´ã® /api/company-ask
```
(å‚ç…§: apps/line-ai-bot/api/webhook.js:12-25)

subject-browser ã¯ Supabase ã®ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã§ã™ã€‚

```ts
const url = process.env.SUPABASE_URL; // Supabase URL
const key = process.env.SUPABASE_SERVICE_ROLE_KEY; // Service Role Key
```
(å‚ç…§: apps/subject-browser/lib/supabaseAdmin.ts:5-15)

## 2. ä¾å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

å„ã‚¢ãƒ—ãƒªã§å€‹åˆ¥ã«ä¾å­˜ã‚’å…¥ã‚Œã¾ã™ã€‚

```bash
# review-page
cd apps/review-page
npm install

# subject-browser
cd ../subject-browser
npm install

# line-ai-bot
cd ../line-ai-bot
npm install
```

## 3. é–‹ç™ºèµ·å‹•

review-page:

```bash
npm run dev # Next.js é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
```
(å‚ç…§: apps/review-page/package.json:5-10)

subject-browser:

```bash
npm run dev # Next.js é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
```
(å‚ç…§: apps/subject-browser/package.json:5-9)

line-ai-bot:

```bash
npm run start # webhook èµ·å‹•
```
(å‚ç…§: apps/line-ai-bot/package.json:8-10)

## 4. ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆä»»æ„ï¼‰

review-page ã® seed ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã§ãã¾ã™ã€‚

```bash
npm run seed:dummy # dummy reviews ã‚’æŠ•å…¥
```
(å‚ç…§: apps/review-page/package.json:5-10)

## 5. å‹•ä½œç¢ºèªã®ãƒã‚¤ãƒ³ãƒˆ

- LINE Webhook ãŒ /api/webhook ã‚’å—ã‘ä»˜ã‘ã‚‹ã“ã¨ã€‚(å‚ç…§: apps/line-ai-bot/vercel.json:1-5)
- LIFF ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ã§ãã‚‹ã“ã¨ã€‚(å‚ç…§: apps/review-page/app/course_reviews/page.tsx:424-520)
- subject-browser ã§å¤§å­¦/ç§‘ç›®ã®æ¤œç´¢ãŒã§ãã‚‹ã“ã¨ã€‚(å‚ç…§: apps/subject-browser/app/page.tsx:38-120)

æ¬¡ã«é€²ã‚€å ´åˆã¯ [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](./03-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
